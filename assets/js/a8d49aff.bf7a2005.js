"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5777],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>k});var a=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},p=Object.keys(e);for(a=0;a<p.length;a++)t=p[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(e);for(a=0;a<p.length;a++)t=p[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var c=a.createContext({}),i=function(e){var n=a.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},u=function(e){var n=i(e.components);return a.createElement(c.Provider,{value:n},e.children)},s="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,p=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),s=i(t),d=l,k=s["".concat(c,".").concat(d)]||s[d]||m[d]||p;return t?a.createElement(k,r(r({ref:n},u),{},{components:t})):a.createElement(k,r({ref:n},u))}));function k(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var p=t.length,r=new Array(p);r[0]=d;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o[s]="string"==typeof e?e:l,r[1]=o;for(var i=2;i<p;i++)r[i]=t[i];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},3995:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>s,frontMatter:()=>p,metadata:()=>o,toc:()=>i});var a=t(7462),l=(t(7294),t(3905));const p={},r="15\u3010react-Hook \uff08\u4e0b\uff09\u3011",o={unversionedId:"React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011",id:"React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011",title:"15\u3010react-Hook \uff08\u4e0b\uff09\u3011",description:"1.React.memo",source:"@site/docs/React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011.md",sourceDirName:"React",slug:"/React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011",permalink:"/docs/React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/React/15\u3010react-Hook \uff08\u4e0b\uff09\u3011.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"14\u3010react-Hook \uff08\u4e0a\uff09\u3011",permalink:"/docs/React/14\u3010react-Hook \uff08\u4e0a\uff09\u3011"},next:{title:"17 \u3010redux\u3011",permalink:"/docs/React/17\u3010redux\u3011"}},c={},i=[{value:"1.React.memo",id:"1reactmemo",level:2},{value:"1.1 \u57fa\u672c\u4ecb\u7ecd",id:"11-\u57fa\u672c\u4ecb\u7ecd",level:3},{value:"1.2 \u95ee\u9898\u7684\u5f15\u51fa",id:"12-\u95ee\u9898\u7684\u5f15\u51fa",level:3},{value:"1.3 \u4f7f\u7528React.memo",id:"13-\u4f7f\u7528reactmemo",level:3},{value:"1.4 \u4f7f\u7528\u6ce8\u610f",id:"14-\u4f7f\u7528\u6ce8\u610f",level:3},{value:"1.5 \u5bb9\u6613\u51fa\u9519\u7684\u60c5\u51b5",id:"15-\u5bb9\u6613\u51fa\u9519\u7684\u60c5\u51b5",level:3},{value:"2.useCallback",id:"2usecallback",level:2},{value:"2.1 \u57fa\u672c\u4ecb\u7ecd",id:"21-\u57fa\u672c\u4ecb\u7ecd",level:3},{value:"2.2 \u89e3\u51b31.5\u9057\u7559\u7684\u95ee\u9898",id:"22-\u89e3\u51b315\u9057\u7559\u7684\u95ee\u9898",level:3},{value:"2.3 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528",id:"23-\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528",level:3},{value:"3.useMemo",id:"3usememo",level:2},{value:"3.1 \u95ee\u9898\u7684\u5f15\u51fa",id:"31-\u95ee\u9898\u7684\u5f15\u51fa",level:3},{value:"3.2 \u4f7f\u7528 useMemo \u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898",id:"32-\u4f7f\u7528-usememo-\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898",level:3},{value:"3.3 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528",id:"33-\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528",level:3},{value:"4.React.forwardRef",id:"4reactforwardref",level:2},{value:"5.useImperativeHandle",id:"5useimperativehandle",level:2}],u={toc:i};function s(e){let{components:n,...t}=e;return(0,l.kt)("wrapper",(0,a.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"15react-hook-\u4e0b"},"15\u3010react-Hook \uff08\u4e0b\uff09\u3011"),(0,l.kt)("h2",{id:"1reactmemo"},"1.React.memo"),(0,l.kt)("h3",{id:"11-\u57fa\u672c\u4ecb\u7ecd"},"1.1 \u57fa\u672c\u4ecb\u7ecd"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u8fd9\u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6\uff0c\u7528\u6765\u505a\u6027\u80fd\u4f18\u5316\u7684\uff0c\u8fd9\u4e2a\u672c\u6765\u5e94\u8be5\u662f\u5199\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"React\u9ad8\u7ea7\u6307\u5f15"),"\u4e2d\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u6848\u4f8b\u4f1a\u548c\u540e\u9762\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"useCallback"),"\u8054\u5408\u8d77\u6765\uff0c\u6240\u4ee5\u5c31\u5199\u5728\u8fd9\u91cc\u4e86")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"React.memo() \u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6\uff0c\u5982\u679c\u4f60\u7684\u7ec4\u4ef6\u5728\u76f8\u540c props \u7684\u60c5\u51b5\u4e0b\u6e32\u67d3\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u901a\u8fc7\u5c06\u5176\u5305\u88c5\u5728 ",(0,l.kt)("inlineCode",{parentName:"li"},"React.memo")," \u4e2d\u8c03\u7528\uff0c\u4ee5\u6b64\u901a\u8fc7\u8bb0\u5fc6\u7ec4\u4ef6\u6e32\u67d3\u7ed3\u679c\u7684\u65b9\u5f0f\u6765\u63d0\u9ad8\u7ec4\u4ef6\u7684\u6027\u80fd\u8868\u73b0\u3002",(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"\u5b83\u63a5\u6536\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u4e14\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5305\u88c5\u8fc7\u7684\u65b0\u7ec4\u4ef6"),(0,l.kt)("li",{parentName:"ul"},"\u5305\u88c5\u8fc7\u7684\u65b0\u7ec4\u4ef6\u5c31\u4f1a\u5177\u6709\u7f13\u5b58\u529f\u80fd\uff0c\u8fd9\u610f\u5473\u7740\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cReact \u5c06\u8df3\u8fc7\u6e32\u67d3\u7ec4\u4ef6\u7684\u64cd\u4f5c\u5e76\u76f4\u63a5\u590d\u7528\u6700\u8fd1\u4e00\u6b21\u6e32\u67d3\u7684\u7ed3\u679c\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5305\u88c5\u8fc7\u540e\uff0c\u53ea\u6709\u7ec4\u4ef6\u7684props\u53d1\u751f\u53d8\u5316\uff0c\u624d\u4f1a\u89e6\u53d1\u7ec4\u4ef6\u7684\u91cd\u65b0\u7684\u6e32\u67d3\uff0c\u5426\u5219\u603b\u662f\u8fd4\u56de\u7f13\u5b58\u4e2d\u7ed3\u679c\u3002\u5982\u679c\u51fd\u6570\u7ec4\u4ef6\u88ab ",(0,l.kt)("inlineCode",{parentName:"li"},"React.memo")," \u5305\u88f9\uff0c\u4e14\u5176\u5b9e\u73b0\u4e2d\u62e5\u6709 ",(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/hooks-state.html"},(0,l.kt)("inlineCode",{parentName:"a"},"useState")),"\uff0c",(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer"},(0,l.kt)("inlineCode",{parentName:"a"},"useReducer"))," \u6216 ",(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usecontext"},(0,l.kt)("inlineCode",{parentName:"a"},"useContext"))," \u7684 Hook\uff0c\u5f53 state \u6216 context \u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b83\u4ecd\u4f1a\u91cd\u65b0\u6e32\u67d3\u3002")))),(0,l.kt)("h3",{id:"12-\u95ee\u9898\u7684\u5f15\u51fa"},"1.2 \u95ee\u9898\u7684\u5f15\u51fa"),(0,l.kt)("p",null,"React\u7ec4\u4ef6\u4f1a\u5728\u4e24\u79cd\u60c5\u51b5\u4e0b\u53d1\u751f\u91cd\u65b0\u6e32\u67d3\u3002\u7b2c\u4e00\u79cd\uff0c\u5f53\u7ec4\u4ef6\u81ea\u8eab\u7684state\u53d1\u751f\u53d8\u5316\u65f6\u3002\u7b2c\u4e8c\u79cd\uff0c\u5f53\u7ec4\u4ef6\u7684\u7236\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\u65f6\u3002\u7b2c\u4e00\u79cd\u60c5\u51b5\u4e0b\u7684\u91cd\u65b0\u6e32\u67d3\u65e0\u53ef\u539a\u975e\uff0cstate\u90fd\u53d8\u4e86\uff0c\u7ec4\u4ef6\u81ea\u7136\u5e94\u8be5\u91cd\u65b0\u8fdb\u884c\u6e32\u67d3\u3002\u4f46\u662f\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4f3c\u4e4e\u5e76\u4e0d\u662f\u603b\u90a3\u4e48\u7684\u5fc5\u8981\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState } from 'react'\n\nexport default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n\n  const clickHandler = () => {\n    setCount(prevState => prevState + 1)\n  }\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      <A />\n    </div>\n  )\n}\n\nfunction A() {\n  console.log('A\u6e32\u67d3')\n  return <div>\u6211\u662fA\u7ec4\u4ef6</div>\n}\n")),(0,l.kt)("p",null,"\u5728\u70b9\u51fb\u589e\u52a0\u540e\uff0c\u6211\u4eec\u53d1\u73b0",(0,l.kt)("inlineCode",{parentName:"p"},"App"),"\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"A"),"\u90fd\u91cd\u65b0\u6e32\u67d3\u4e86\u3002"),(0,l.kt)("p",null,"\u5f53APP\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\u65f6\uff0cA\u7ec4\u4ef6\u4e5f\u4f1a\u91cd\u65b0\u6e32\u67d3\u3002A\u7ec4\u4ef6\u4e2d\u6ca1\u6709state\uff0c\u751a\u81f3\u8fdeprops\u90fd\u6ca1\u6709\u8bbe\u7f6e\u3002\u6362\u8a00\u4e4b\uff0cA\u7ec4\u4ef6\u65e0\u8bba\u5982\u4f55\u6e32\u67d3\uff0c\u6bcf\u6b21\u6e32\u67d3\u7684\u7ed3\u679c\u90fd\u662f\u76f8\u540c\u7684\uff0c\u867d\u7136\u91cd\u6e32\u67d3\u5e76\u4e0d\u4f1a\u5e94\u7528\u5230\u771f\u5b9eDOM\u4e0a\uff0c\u4f46\u5f88\u663e\u7136\u8fd9\u79cd\u6e32\u67d3\u662f\u5b8c\u5168\u6ca1\u6709\u5fc5\u8981\u7684\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/86fdfde2cc02ab0826730bc14eefc637c2696ecd.png",alt:"image-20221030172720453"})),(0,l.kt)("p",null,"\u4e3a\u4e86\u51cf\u5c11\u50cfA\u7ec4\u4ef6\u8fd9\u6837\u7ec4\u4ef6\u7684\u6e32\u67d3\uff0cReact\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u6cd5",(0,l.kt)("inlineCode",{parentName:"p"},"React.memo()"),"\u3002\u8be5\u65b9\u6cd5\u662f\u4e00\u4e2a\u9ad8\u9636\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u6765\u6839\u636e\u7ec4\u4ef6\u7684props\u5bf9\u7ec4\u4ef6\u8fdb\u884c\u7f13\u5b58\uff0c\u5f53\u4e00\u4e2a\u7ec4\u4ef6\u7684\u7236\u7ec4\u4ef6\u53d1\u751f\u91cd\u65b0\u6e32\u67d3\uff0c\u800c\u5b50\u7ec4\u4ef6\u7684props\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b83\u4f1a\u76f4\u63a5\u5c06\u7f13\u5b58\u4e2d\u7684\u7ec4\u4ef6\u6e32\u67d3\u7ed3\u679c\u8fd4\u56de\u800c\u4e0d\u662f\u518d\u6b21\u89e6\u53d1\u5b50\u7ec4\u4ef6\u7684\u91cd\u65b0\u6e32\u67d3\uff0c\u8fd9\u6837\u4e00\u6765\u5c31\u5927\u5927\u7684\u964d\u4f4e\u4e86\u5b50\u7ec4\u4ef6\u91cd\u65b0\u6e32\u67d3\u7684\u6b21\u6570\u3002"),(0,l.kt)("h3",{id:"13-\u4f7f\u7528reactmemo"},"1.3 \u4f7f\u7528React.memo"),(0,l.kt)("p",null,"\u4f7f\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"React.memo"),"\u5305\u88f9",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u8fd9\u91cc\u53ea\u662f\u4e3a\u4e86\u6f14\u793a\u65b9\u4fbf\uff0c\u628a\u6240\u6709\u7ec4\u4ef6\u5199\u4e00\u4e2a\u6587\u4ef6\uff0c\u5c31\u7528\u8fd9\u79cd\u65b9\u5f0f\u5305\u88f9",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6"),",\u5e73\u65f6\u5355\u6587\u4ef6\u7ec4\u4ef6\u7684\u65f6\u5019\u6211\u4eec\u8fd9\u6837\u4f7f\u7528,",(0,l.kt)("inlineCode",{parentName:"p"},"export default React.memo(A)"))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState } from 'react'\n\nexport default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n\n  const clickHandler = () => {\n    setCount(prevState => prevState + 1)\n  }\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      <A />\n    </div>\n  )\n}\n\nconst A = React.memo(() => {\n  console.log('A\u6e32\u67d3')\n  return <div>\u6211\u662fA\u7ec4\u4ef6</div>\n})\n")),(0,l.kt)("p",null,"\u4fee\u6539\u540e\u7684\u4ee3\u7801\u4e2d\uff0c\u5e76\u6ca1\u6709\u76f4\u63a5\u4f7f\u7528A\u7ec4\u4ef6\uff0c\u800c\u662f\u5728A\u7ec4\u4ef6\u5916\u5c42\u5957\u4e86\u4e00\u5c42\u51fd\u6570",(0,l.kt)("inlineCode",{parentName:"p"},"React.memo()"),"\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u8fd4\u56de\u7684A\u7ec4\u4ef6\u5c31\u589e\u52a0\u4e86\u7f13\u5b58\u529f\u80fd\uff0c\u53ea\u6709\u5f53A\u7ec4\u4ef6\u7684props\u5c5e\u6027\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u624d\u4f1a\u89e6\u53d1\u7ec4\u4ef6\u7684\u91cd\u65b0\u6e32\u67d3\u3002memo\u53ea\u4f1a\u6839\u636eprops\u5224\u65ad\u662f\u5426\u9700\u8981\u91cd\u65b0\u6e32\u67d3\uff0c\u548cstate\u548ccontext\u65e0\u5173\uff0cstate\u6216context\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u7ec4\u4ef6\u4f9d\u7136\u4f1a\u6b63\u5e38\u7684\u8fdb\u884c\u91cd\u65b0\u6e32\u67d3"),(0,l.kt)("p",null,"\u5728\u70b9\u51fb\u589e\u52a0\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u53ea\u6709",(0,l.kt)("inlineCode",{parentName:"p"},"App"),"\u91cd\u65b0\u6e32\u67d3\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/0a613f29500b63ae26e2db2870ef9c18f3e7815f.png",alt:"image-20221030173239606"})),(0,l.kt)("p",null,"\u8fd9\u65f6\u6211\u4eec\u6539\u4e0b\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"export default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n\n  const clickHandler = () => {\n    setCount(prevState => prevState + 1)\n  }\n    \n  // \u589e\u52a0\n  const test = count % 4 === 0\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      {/* \u6539\u52a8 */}\n      <A test={test} />\n    </div>\n  )\n}\n\nconst A = React.memo(props => {\n  console.log('A\u6e32\u67d3')\n  return (\n    <div>\n      \u6211\u662fA\u7ec4\u4ef6\n      {/* \u589e\u52a0 */}\n      <p>{props.test && 'props.test \u4e3a true'}</p>\n    </div>\n  )\n})\n")),(0,l.kt)("p",null,"\u8fd9\u6b21\u52a0\u4e86\u4e2a\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4f20\u7ed9",(0,l.kt)("inlineCode",{parentName:"p"},"A"),"\u7ec4\u4ef6\uff0c\u4e00\u5f00\u59cb\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"false"),"\uff0c\u53ea\u6709\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"true"),"\u7684\u65f6\u5019\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"A"),"\u7ec4\u4ef6\u624d\u4f1a\u91cd\u65b0\u6e32\u67d3"),(0,l.kt)("p",null,"\u8fd9\u65f6\u754c\u9762\u662f\u8fd9\u6837\u7684"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/9ddba53bea0c611e1c3e2837761f2b60f2f29322.png",alt:"image-20221030174105525"})),(0,l.kt)("p",null,"\u70b9\u51fb3\u6b21\u540e\uff0c\u8868\u8fbe\u5f0f\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"true"),"\uff0cA\u7ec4\u4ef6\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"props"),"\u53d1\u751f\u6539\u53d8\uff0c\u6240\u4ee5\u91cd\u65b0\u6e32\u67d3\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/0f5ff4c127b4d404f1207ccbf497a5cd271d4651.png",alt:"image-20221030173754653"})),(0,l.kt)("h3",{id:"14-\u4f7f\u7528\u6ce8\u610f"},"1.4 \u4f7f\u7528\u6ce8\u610f"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u6b64\u65b9\u6cd5\u4ec5\u4f5c\u4e3a",(0,l.kt)("strong",{parentName:"li"},(0,l.kt)("a",{parentName:"strong",href:"https://zh-hans.reactjs.org/docs/optimizing-performance.html"},"\u6027\u80fd\u4f18\u5316")),"\u7684\u65b9\u5f0f\u800c\u5b58\u5728\u3002\u4f46\u8bf7\u4e0d\u8981\u4f9d\u8d56\u5b83\u6765\u201c\u963b\u6b62\u201d\u6e32\u67d3\uff0c\u56e0\u4e3a\u8fd9\u4f1a\u4ea7\u751f bug\u3002"),(0,l.kt)("li",{parentName:"ol"},"\u4e0e class \u7ec4\u4ef6\u4e2d ",(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/react-component.html#shouldcomponentupdate"},(0,l.kt)("inlineCode",{parentName:"a"},"shouldComponentUpdate()"))," \u65b9\u6cd5\u4e0d\u540c\u7684\u662f\uff0c\u5982\u679c props \u76f8\u7b49\uff0c",(0,l.kt)("inlineCode",{parentName:"li"},"areEqual")," \u4f1a\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"li"},"true"),"\uff1b\u5982\u679c props \u4e0d\u76f8\u7b49\uff0c\u5219\u8fd4\u56de ",(0,l.kt)("inlineCode",{parentName:"li"},"false"),"\u3002\u8fd9\u4e0e ",(0,l.kt)("inlineCode",{parentName:"li"},"shouldComponentUpdate")," \u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u76f8\u53cd\u3002")),(0,l.kt)("h3",{id:"15-\u5bb9\u6613\u51fa\u9519\u7684\u60c5\u51b5"},"1.5 \u5bb9\u6613\u51fa\u9519\u7684\u60c5\u51b5"),(0,l.kt)("p",null,"\u5148\u56de\u5230\u8fd9\u4e2a\u6848\u4f8b\u7684\u521d\u59cb\u4ee3\u7801\uff0c\u5728\u8fd9\u4e4b\u4e0a\u8fdb\u884c\u4fee\u6539"),(0,l.kt)("p",null,"\u6211\u4eec\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"App\u7ec4\u4ef6"),"\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u65b9\u6cd5\u4f20\u9012\u7ed9",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6"),"\uff0c\u8ba9",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6"),"\u4e5f\u80fd\u591f\u6539\u53d8",(0,l.kt)("inlineCode",{parentName:"p"},"App\u7ec4\u4ef6"),"\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"state")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState } from 'react'\n\nexport default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n\n  const clickHandler = () => {\n    setCount(prevState => prevState + 1)\n  }\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      <A clickHandler={clickHandler} />\n    </div>\n  )\n}\n\nconst A = React.memo(props => {\n  console.log('A\u6e32\u67d3')\n  return (\n    <div>\n      \u6211\u662fA\u7ec4\u4ef6\n      <button onClick={props.clickHandler}>A\u7ec4\u4ef6\u7684\u589e\u52a0</button>\n    </div>\n  )\n})\n")),(0,l.kt)("p",null,"\u70b9\u51fb",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6\u7684\u589e\u52a0"),",\u53d1\u73b0",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6"),"\u4e5f\u91cd\u65b0\u6e32\u67d3\u4e86"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/3e8995b7352d72b47e772ea6c7fed94ef1531267.png",alt:"image-20221030175830062"})),(0,l.kt)("p",null,"\u8fd9\u662f\u56e0\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"App\u7ec4\u4ef6"),"\u91cd\u65b0\u6e32\u67d3\u7684\u65f6\u5019\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u4e5f\u91cd\u65b0\u521b\u5efa\u4e86\uff0c\u8fd9\u65f6\u4f20\u9012\u7ed9\u5b50\u7ec4\u4ef6\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u548c\u4e0a\u4e00\u6b21\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5",(0,l.kt)("inlineCode",{parentName:"p"},"react.memo"),"\u5931\u6548\u4e86\u3002"),(0,l.kt)("p",null,"\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528",(0,l.kt)("inlineCode",{parentName:"p"},"useCallback"),"\u89e3\u51b3\u3002"),(0,l.kt)("h2",{id:"2usecallback"},"2.useCallback"),(0,l.kt)("h3",{id:"21-\u57fa\u672c\u4ecb\u7ecd"},"2.1 \u57fa\u672c\u4ecb\u7ecd"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const memoizedCallback = useCallback(\n  () => {\n    doSomething(a, b);\n  },\n  [a, b],\n);\n")),(0,l.kt)("p",null,"\u628a\u5185\u8054\u56de\u8c03\u51fd\u6570\u53ca\u4f9d\u8d56\u9879\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 ",(0,l.kt)("inlineCode",{parentName:"p"},"useCallback"),"\uff0c\u5b83\u5c06\u8fd4\u56de\u8be5\u56de\u8c03\u51fd\u6570\u7684 memoized \u7248\u672c\uff0c\u8be5\u56de\u8c03\u51fd\u6570\u4ec5\u5728\u67d0\u4e2a\u4f9d\u8d56\u9879\u6539\u53d8\u65f6\u624d\u4f1a\u66f4\u65b0\u3002\u5f53\u4f60\u628a\u56de\u8c03\u51fd\u6570\u4f20\u9012\u7ed9\u7ecf\u8fc7\u4f18\u5316\u7684\u5e76\u4f7f\u7528\u5f15\u7528\u76f8\u7b49\u6027\u53bb\u907f\u514d\u975e\u5fc5\u8981\u6e32\u67d3\uff08\u4f8b\u5982 ",(0,l.kt)("inlineCode",{parentName:"p"},"shouldComponentUpdate"),"\uff09\u7684\u5b50\u7ec4\u4ef6\u65f6\uff0c\u5b83\u5c06\u975e\u5e38\u6709\u7528\u3002"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"useCallback"),"\u548c",(0,l.kt)("inlineCode",{parentName:"p"},"useMemo"),"\u8bbe\u8ba1\u7684\u521d\u8877\u662f\u7528\u6765\u505a\u6027\u80fd\u4f18\u5316\u7684\u3002\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"Class Component"),"\u4e2d\u8003\u8651\u4ee5\u4e0b\u7684\u573a\u666f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},"class Foo extends Component {\n  handleClick() {\n    console.log('Click happened');\n  }\n  render() {\n    return <Button onClick={() => this.handleClick()}>Click Me</Button>;\n  }\n}\n")),(0,l.kt)("p",null,"\u4f20\u7ed9 Button \u7684 onClick \u65b9\u6cd5\u6bcf\u6b21\u90fd\u662f\u91cd\u65b0\u521b\u5efa\u7684\uff0c\u8fd9\u4f1a\u5bfc\u81f4\u6bcf\u6b21 Foo render \u7684\u65f6\u5019\uff0cButton \u4e5f\u8ddf\u7740 render\u3002\u4f18\u5316\u65b9\u6cd5\u6709 2 \u79cd\uff0c\u7bad\u5934\u51fd\u6570\u548c bind\u3002\u4e0b\u9762\u4ee5 bind \u4e3a\u4f8b\u5b50\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},"class Foo extends Component {\n  constructor(props) {\n    super(props);\n    this.handleClick = this.handleClick.bind(this);\n  }\n  handleClick() {\n    console.log('Click happened');\n  }\n  render() {\n    return <Button onClick={this.handleClick}>Click Me</Button>;\n  }\n}\n")),(0,l.kt)("p",null,"\u540c\u6837\u7684\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"Function Component"),"\u4e5f\u6709\u8fd9\u4e2a\u95ee\u9898\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},"function Foo() {\n  const [count, setCount] = useState(0);\n\n  const handleClick() {\n    console.log(`Click happened with dependency: ${count}`)\n  }\n  return <Button onClick={handleClick}>Click Me</Button>;\n}\n")),(0,l.kt)("p",null,"\u800c React \u7ed9\u51fa\u7684\u65b9\u6848\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"useCallback")," Hook\u3002\u5728\u4f9d\u8d56\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b (\u5728\u6211\u4eec\u7684\u4f8b\u5b50\u4e2d\u662f count )\uff0c\u5b83\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u5f15\u7528\uff0c\u907f\u514d\u5b50\u7ec4\u4ef6\u8fdb\u884c\u65e0\u610f\u4e49\u7684\u91cd\u590d\u6e32\u67d3"),(0,l.kt)("h3",{id:"22-\u89e3\u51b315\u9057\u7559\u7684\u95ee\u9898"},"2.2 \u89e3\u51b31.5\u9057\u7559\u7684\u95ee\u9898"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-javascript"},"/*\n*   useCallback()\n*       \u8fd9\u4e2ahook\u4f1a\u7f13\u5b58\u65b9\u6cd5\u7684\u5f15\u7528\n*       \u53c2\u6570\uff1a\n*           1. \u56de\u8c03\u51fd\u6570\n*           2. \u4f9d\u8d56\u6570\u7ec4\n*               - \u5f53\u4f9d\u8d56\u6570\u7ec4\u4e2d\u7684\u53d8\u91cf\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u56de\u8c03\u51fd\u6570\u624d\u4f1a\u91cd\u65b0\u521b\u5efa\n*               - \u5982\u679c\u4e0d\u6307\u5b9a\u4f9d\u8d56\u6570\u7ec4\uff0c\u56de\u8c03\u51fd\u6570\u6bcf\u6b21\u90fd\u4f1a\u91cd\u65b0\u521b\u5efa\n*               - \u4e00\u5b9a\u8981\u5c06\u56de\u8c03\u51fd\u6570\u4e2d\u4f7f\u7528\u5230\u7684\u6240\u6709\u53d8\u91cf\u90fd\u8bbe\u7f6e\u5230\u4f9d\u8d56\u6570\u7ec4\u4e2d\n*                   \u9664\u4e86\uff08setState\uff09\n* */\n")),(0,l.kt)("p",null,"\u6211\u4eec\u5c06",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u65b9\u6cd5\u6539\u9020\u4e00\u4e0b"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"  const clickHandler = useCallback(() => {\n    setCount(prevState => prevState + 1)\n  }, [])\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4e00\u5b9a\u8981\u52a0\uff0c\u4e0d\u7136\u548c\u5e73\u5e38\u5199\u6ca1\u6709\u533a\u522b"),(0,l.kt)("p",{parentName:"blockquote"},"\u4f9d\u8d56\u9879",(0,l.kt)("inlineCode",{parentName:"p"},"[]"),"\u7684\u610f\u601d\u662f\u53ea\u6709\u7b2c\u4e00\u6b21\u6e32\u67d3\u65f6\u624d\u4f1a\u521b\u5efa\uff0c\u4e4b\u540e\u90fd\u4e0d\u4f1a\u91cd\u65b0\u521b\u5efa\u4e86")),(0,l.kt)("p",null,"\u70b9\u51fb",(0,l.kt)("inlineCode",{parentName:"p"},"A\u7ec4\u4ef6\u7684\u589e\u52a0"),",\u53d1\u73b0\u53ea\u6709",(0,l.kt)("inlineCode",{parentName:"p"},"App\u7ec4\u4ef6"),"\u91cd\u65b0\u6e32\u67d3\u4e86\u3002\u56e0\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u6ca1\u6709\u91cd\u65b0\u521b\u5efa\uff0c\u4f20\u7ed9\u5b50\u7ec4\u4ef6\u7684\u6ca1\u6709\u53d8\u5316\uff0c\u6240\u4ee5\u5b50\u7ec4\u4ef6\u8fd9\u6b21\u6ca1\u6709\u91cd\u65b0\u6e32\u67d3\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/2e7d34de3518ecb98ac3433cae205a4683a069f5.png",alt:"image-20221030180349406"})),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"\u5b8c\u6574\u4ee3\u7801")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState, useCallback } from 'react'\n\nexport default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n\n  const clickHandler = useCallback(() => {\n    setCount(prevState => prevState + 1)\n  }, [])\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      <A clickHandler={clickHandler} />\n    </div>\n  )\n}\n\nconst A = React.memo(props => {\n  console.log('A\u6e32\u67d3')\n  return (\n    <div>\n      \u6211\u662fA\u7ec4\u4ef6\n      <button onClick={props.clickHandler}>A\u7ec4\u4ef6\u7684\u589e\u52a0</button>\n    </div>\n  )\n})\n")),(0,l.kt)("h3",{id:"23-\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528"},"2.3 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528"),(0,l.kt)("p",null,"\u7ee7\u7eed\u6539\u9020\u4e0a\u9762\u7684\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useState, useCallback } from 'react'\n\nexport default function App() {\n  console.log('App\u6e32\u67d3')\n\n  const [count, setCount] = useState(1)\n  // \u589e\u52a0\n  const [num, setNum] = useState(1)\n\n  const clickHandler = useCallback(() => {\n    setCount(prevState => prevState + num)\n  // \u589e\u52a0\n    setNum(prevState => prevState + 1)\n  }, [])\n\n  return (\n    <div>\n      <h2>App -- {count}</h2>\n      <button onClick={clickHandler}>\u589e\u52a0</button>\n      <A clickHandler={clickHandler} />\n    </div>\n  )\n}\n\nconst A = React.memo(props => {\n  console.log('A\u6e32\u67d3')\n  return (\n    <div>\n      \u6211\u662fA\u7ec4\u4ef6\n      <button onClick={props.clickHandler}>A\u7ec4\u4ef6\u7684\u589e\u52a0</button>\n    </div>\n  )\n})\n")),(0,l.kt)("p",null,"\u589e\u52a0\u4e86\u4e00\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"num"),"\uff0c\u8ba9\u6bcf\u4e00\u6b21",(0,l.kt)("inlineCode",{parentName:"p"},"count"),"\u7684\u589e\u52a0\u6bd4\u4e0a\u6b21\u591a1\uff0c\u73b0\u5728\u8fd9\u6837\u5199\u662f\u6709\u95ee\u9898\u7684\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/2e04eb7727a7b875a3b771761c4c4d2ac9e30b04.png",alt:"image-20221030181249832"})),(0,l.kt)("p",null,"\u70b9\u51fb\u4e86\u4e24\u6b21\u589e\u52a0\u540e\uff0c\u9884\u671f\u503c\u5e94\u8be5\u662f4\uff0c\u4f46\u662f\u663e\u793a\u7684\u662f3\uff0c\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f"),(0,l.kt)("p",null,"\u56e0\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"clickHandler"),"\u53ea\u5728\u521d\u6b21\u6e32\u67d3\u7684\u65f6\u5019\u521b\u5efa\uff0c\u5f53\u65f6",(0,l.kt)("inlineCode",{parentName:"p"},"num"),"\u7684\u503c\u662f1\uff0c\u8fd9\u4e2a\u51fd\u6570\u4e00\u76f4\u6ca1\u6709\u91cd\u65b0\u521b\u5efa\uff0c\u5185\u90e8\u7528\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"num"),"\u4e00\u76f4\u662f1"),(0,l.kt)("p",null,"\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u52a0\u4e00\u4e2a\u4f9d\u8d56\u9879"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const clickHandler = useCallback(() => {\n    setCount(prevState => prevState + num)\n    setNum(prevState => prevState + 1)\n  }, [num])\n")),(0,l.kt)("p",null,"\u8fd9\u6837",(0,l.kt)("inlineCode",{parentName:"p"},"num"),"\u53d8\u5316\u4e86\uff0c\u8fd9\u4e2a\u51fd\u6570\u4e5f\u4f1a\u91cd\u65b0\u521b\u5efa\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/d1f9956dac9668ab3c7af6dc5f093f1155f39d6b.png",alt:"image-20221030181534667"})),(0,l.kt)("p",null,"\u70b9\u51fb\u4e86\u4e24\u6b21\u589e\u52a0\u540e\uff0ccount\u53d8\u6210\u4e86\u9884\u671f\u503c4\u3002"),(0,l.kt)("h2",{id:"3usememo"},"3.useMemo"),(0,l.kt)("p",null,"useMemo\u548cuseCallback\u5341\u5206\u76f8\u4f3c\uff0cuseCallback\u7528\u6765\u7f13\u5b58\u51fd\u6570\u5bf9\u8c61\uff0cuseMemo\u7528\u6765\u7f13\u5b58\u51fd\u6570\u7684\u6267\u884c\u7ed3\u679c\u3002\u5728\u7ec4\u4ef6\u4e2d\uff0c\u4f1a\u6709\u4e00\u4e9b\u51fd\u6570\u5177\u6709\u5341\u5206\u7684\u590d\u6742\u7684\u903b\u8f91\uff0c\u6267\u884c\u901f\u5ea6\u6bd4\u8f83\u6162\u3002\u95ed\u4e86\u907f\u514d\u8fd9\u4e9b\u6267\u884c\u901f\u5ea6\u6162\u7684\u51fd\u6570\u8fd4\u56de\u6267\u884c\uff0c\u53ef\u4ee5\u901a\u8fc7useMemo\u6765\u7f13\u5b58\u5b83\u4eec\u7684\u6267\u884c\u7ed3\u679c\uff0c\u50cf\u662f\u8fd9\u6837\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const result = useMemo(()=>{\n    return \u590d\u6742\u903b\u8f91\u51fd\u6570();\n},[\u4f9d\u8d56\u9879])\n")),(0,l.kt)("p",null,"useMemo\u4e2d\u7684\u51fd\u6570\u4f1a\u5728\u4f9d\u8d56\u9879\u53d1\u751f\u53d8\u5316\u65f6\u6267\u884c\uff0c\u6ce8\u610f\uff01\u662f\u6267\u884c\uff0c\u8fd9\u70b9\u548cuseCallback\u4e0d\u540c\uff0cuseCallback\u662f\u521b\u5efa\u3002\u6267\u884c\u540e\u8fd4\u56de\u6267\u884c\u7ed3\u679c\uff0c\u5982\u679c\u4f9d\u8d56\u9879\u4e0d\u53d1\u751f\u53d8\u5316\uff0c\u5219\u4e00\u76f4\u4f1a\u8fd4\u56de\u4e0a\u6b21\u7684\u7ed3\u679c\uff0c\u4e0d\u4f1a\u518d\u6267\u884c\u51fd\u6570\u3002\u8fd9\u6837\u4e00\u6765\u5c31\u907f\u514d\u590d\u6742\u903b\u8f91\u7684\u91cd\u590d\u6267\u884c\u3002"),(0,l.kt)("h3",{id:"31-\u95ee\u9898\u7684\u5f15\u51fa"},"3.1 \u95ee\u9898\u7684\u5f15\u51fa"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useMemo, useState } from 'react'\n\nconst App = () => {\n  const [count, setCount] = useState(1)\n\n  let a = 123\n  let b = 456\n\n  function sum(a, b) {\n    console.log('sum\u6267\u884c\u4e86')\n    return a + b\n  }\n    \n  return (\n    <div>\n      <h1>App</h1>\n      <p>sum\u7684\u7ed3\u679c\uff1a{sum(a, b)}</p>\n      <h3>{count}</h3>\n      <button onClick={() => setCount(prevState => prevState + 1)}>\u70b9\u6211</button>\n    </div>\n  )\n}\n\nexport default App\n")),(0,l.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2a\u8ba1\u6570\u5668\u6848\u4f8b\uff0c\u4f46\u662f\u591a\u6dfb\u52a0\u4e86\u4e00\u4e2a\u51fd\u6570\u5c55\u793a\u7ed3\u679c\uff0c\u8fd9\u79cd\u60c5\u51b5\u8fd9\u4e2a\u51fd\u6570\u53ea\u9700\u8981\u5728\u4e00\u5f00\u59cb\u8c03\u7528\u4e00\u6b21\u5c31\u591f\u4e86\uff0c\u4f46\u662f",(0,l.kt)("inlineCode",{parentName:"p"},"count"),"\u7684\u6539\u53d8\u4f1a\u5bfc\u81f4\u91cd\u65b0\u6e32\u67d3\u6a21\u677f\uff0c\u8fd9\u6837",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u51fd\u6570\u4e5f\u4f1a\u53cd\u590d\u6267\u884c\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/2e224dfe8aa7df39ae77c2d98bede3d590d7d1b8.png",alt:"image-20221107143139632"})),(0,l.kt)("p",null,"\u73b0\u5728\u8fd9\u4e2a",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u51fd\u6570\u592a\u7b80\u5355\u4e86\uff0c\u4f53\u73b0\u4e0d\u51fa\u6027\u80fd\u4e0a\u7684\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u628asum\u4e2d\u7684\u903b\u8f91\u6539\u590d\u6742\u4e00\u70b9\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useMemo, useState } from 'react'\n\nconst App = () => {\n  const [count, setCount] = useState(1)\n\n  let a = 123\n  let b = 456\n\n  function sum(a, b) {\n    console.log('sum\u6267\u884c\u4e86')\n    const begin = +new Date()\n    while (true) {\n      if (Date.now() - begin > 3000) break\n    }\n    return a + b\n  }\n  return (\n    <div>\n      <h1>App</h1>\n      <p>sum\u7684\u7ed3\u679c\uff1a{sum(a, b)}</p>\n      <h3>{count}</h3>\n      <button onClick={() => setCount(prevState => prevState + 1)}>\u70b9\u6211</button>\n    </div>\n  )\n}\n\nexport default App\n")),(0,l.kt)("p",null,"\u589e\u52a0\u4e86\u4e00\u4e2a\u529f\u80fd\uff0c\u8ba9\u8fd9\u4e2a\u51fd\u6570\u8d77\u78013\u79d2\u624d\u80fd\u6267\u884c\u5b8c\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/67454e5c8256260a19f3cc84d2b1da78935ec5d3.png",alt:"image-20221107143451560"})),(0,l.kt)("p",null,"\u8fd9\u4e2a\u65f6\u5019\u56e0\u4e3a",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u51fd\u6570\u89813\u79d2\u624d\u80fd\u6267\u884c\u5b8c\uff0c\u5bfc\u81f4\u4e0b\u9762\u6570\u5b57\u663e\u793a\u4e5f\u53d8\u6162\u4e863\u79d2\u3002"),(0,l.kt)("h3",{id:"32-\u4f7f\u7528-usememo-\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898"},"3.2 \u4f7f\u7528 useMemo \u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("p",null,"\u6539\u5199\u6a21\u677f\u4e2d\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u65b9\u6cd5\u7684\u8c03\u7528"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"<p>sum\u7684\u7ed3\u679c\uff1a{useMemo(() => sum(a, b), [])}</p>\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/790ec03b82b253c6a80c823542d21b745adb8035.png",alt:"image-20221107143946116"})),(0,l.kt)("p",null,"\u7b2c\u4e00\u6b21\u52a0\u8f7d\u6162\u662f\u4e0d\u53ef\u907f\u514d\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u94a9\u5b50\u51fd\u6570\u5c06",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u51fd\u6570\u7684\u8fd4\u56de\u503c\u7f13\u5b58\u8d77\u6765\uff0c\u8fd9\u6837\u6211\u4eec\u6a21\u677f\u91cd\u65b0\u6e32\u67d3\u65f6\u5c31\u6ca1\u6709\u518d\u53bb\u6267\u884c",(0,l.kt)("inlineCode",{parentName:"p"},"sum"),"\u51fd\u6570\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528\u4e0a\u4e00\u6b21\u7684\u8fd4\u56de\u503c\u3002"),(0,l.kt)("h3",{id:"33-\u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528"},"3.3 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7684\u4f7f\u7528"),(0,l.kt)("p",null,"\u7ee7\u7eed\u6539\u9020\u4e0a\u9762\u7684\u4ee3\u7801\uff0c\u628a",(0,l.kt)("inlineCode",{parentName:"p"},"Sum"),"\u5355\u72ec\u62bd\u79bb\u6210\u4e00\u4e2a\u7ec4\u4ef6"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Sum.jsx")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React from 'react'\n\nexport default function Sum(props) {\n  console.log('Sum\u6267\u884c\u4e86')\n  return <span>{props.a + props.b}</span>\n}\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("p",null,"\u6dfb\u52a0\u4e86\u4e00\u4e2a\u529f\u80fd\u53ef\u4ee5\u53d8\u6362",(0,l.kt)("inlineCode",{parentName:"p"},"a"),"\u7684\u503c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useMemo, useState } from 'react'\nimport Sum from './Sum'\n\nconst App = () => {\n  const [count, setCount] = useState(1)\n\n  let a = 123\n  let b = 456\n\n  if (count % 2 === 0) a = a + 1\n\n  const result = useMemo(() => <Sum a={a} b={b} />, [])\n\n  return (\n    <div>\n      <h1>App</h1>\n      <p>sum\u7684\u7ed3\u679c\uff1a{result}</p>\n      <h3>{count}</h3>\n      <button onClick={() => setCount(prevState => prevState + 1)}>\u70b9\u6211</button>\n    </div>\n  )\n}\n\nexport default App\n")),(0,l.kt)("p",null,"\u73b0\u5728\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c",(0,l.kt)("inlineCode",{parentName:"p"},"Sum"),"\u7ec4\u4ef6\u63a5\u6536\u7684\u503c\u53d8\u5316\u4e86\uff0c\u7f51\u9875\u4e0a\u663e\u793a\u7684\u8fd8\u662f\u539f\u6765\u7684\u7f13\u5b58\u503c\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u8981\u5229\u7528\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/deecc395220dcff4c6c9acb8b71bbda6ca6a5ae7.png",alt:"image-20221107145159066"})),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"const result = useMemo(() => <Sum a={a} b={b} />, [a])\n")),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u8fd9\u91cc\u7684\u610f\u601d\u548c\u4ee5\u524d\u662f\u4e00\u6837\u7684\uff0c\u5982\u679c",(0,l.kt)("inlineCode",{parentName:"p"},"a"),"\u7684\u503c\u53d8\u5316\u4e86\uff0c\u5c06\u4f1a\u91cd\u65b0\u8ba1\u7b97\u3002")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/931d55fbd9ffca98894a4b8178c8da9751231923.png",alt:"image-20221107145403725"})),(0,l.kt)("h2",{id:"4reactforwardref"},"4.React.forwardRef"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u8fd9\u662f\u4e00\u4e2a\u9ad8\u9636\u7ec4\u4ef6\uff0c\u7528\u6765\u505a\u6027\u80fd\u4f18\u5316\u7684\uff0c\u8fd9\u4e2a\u672c\u6765\u5e94\u8be5\u662f\u5199\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"React\u9ad8\u7ea7\u6307\u5f15"),"\u4e2d\u7684\uff0c\u4f46\u662f\u8fd9\u4e2a\u6848\u4f8b\u4f1a\u548c\u540e\u9762\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"useImperativeHandle"),"\u8054\u5408\u8d77\u6765\uff0c\u6240\u4ee5\u5c31\u5199\u5728\u8fd9\u91cc\u4e86")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"React.forwardRef")," \u4f1a\u521b\u5efa\u4e00\u4e2aReact\u7ec4\u4ef6\uff0c\u8fd9\u4e2a\u7ec4\u4ef6\u80fd\u591f\u5c06\u5176\u63a5\u53d7\u7684 ",(0,l.kt)("a",{parentName:"p",href:"https://zh-hans.reactjs.org/docs/refs-and-the-dom.html"},"ref")," \u5c5e\u6027\u8f6c\u53d1\u5230\u5176\u7ec4\u4ef6\u6811\u4e0b\u7684\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u4e2d\u3002\u8fd9\u79cd\u6280\u672f\u5e76\u4e0d\u5e38\u89c1\uff0c\u4f46\u5728\u4ee5\u4e0b\u4e24\u79cd\u573a\u666f\u4e2d\u7279\u522b\u6709\u7528\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/forwarding-refs.html#forwarding-refs-to-dom-components"},"\u8f6c\u53d1 refs \u5230 DOM \u7ec4\u4ef6")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://zh-hans.reactjs.org/docs/forwarding-refs.html#forwarding-refs-in-higher-order-components"},"\u5728\u9ad8\u9636\u7ec4\u4ef6\u4e2d\u8f6c\u53d1 refs"))),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"React.forwardRef")," \u63a5\u53d7\u6e32\u67d3\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u3002React \u5c06\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"props")," \u548c ",(0,l.kt)("inlineCode",{parentName:"p"},"ref")," \u4f5c\u4e3a\u53c2\u6570\u6765\u8c03\u7528\u6b64\u51fd\u6570\u3002\u6b64\u51fd\u6570\u5e94\u8fd4\u56de React \u8282\u70b9\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useRef } from 'react'\n\nconst Child = React.forwardRef((props, ref) => {\n  return (\n    <>\n      <h2>\u8fd9\u662fChild\u7ec4\u4ef6</h2>\n      <input type=\"text\" ref={ref} />\n    </>\n  )\n})\n\nexport default function App() {\n  const childRef = useRef(null)\n  console.log(childRef)\n  return (\n    <div>\n      <h2>\u8fd9\u662fApp\u7ec4\u4ef6</h2>\n      <Child ref={childRef} />\n    </div>\n  )\n}\n")),(0,l.kt)("p",null,"\u5728\u4e0a\u8ff0\u7684\u793a\u4f8b\u4e2d\uff0cReact \u4f1a\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"<Child ref={childRef}>")," \u5143\u7d20\u7684 ",(0,l.kt)("inlineCode",{parentName:"p"},"ref")," \u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u9012\u7ed9 ",(0,l.kt)("inlineCode",{parentName:"p"},"React.forwardRef")," \u51fd\u6570\u4e2d\u7684\u6e32\u67d3\u51fd\u6570\u3002\u8be5\u6e32\u67d3\u51fd\u6570\u4f1a\u5c06 ",(0,l.kt)("inlineCode",{parentName:"p"},"ref")," \u4f20\u9012\u7ed9 ",(0,l.kt)("inlineCode",{parentName:"p"},"<input ref={ref}>")," \u5143\u7d20\u3002"),(0,l.kt)("p",null,"\u56e0\u6b64\uff0c\u5f53 React \u9644\u52a0\u4e86 ref \u5c5e\u6027\u4e4b\u540e\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"ref.current")," \u5c06\u76f4\u63a5\u6307\u5411 ",(0,l.kt)("inlineCode",{parentName:"p"},"<input>")," DOM \u5143\u7d20\u5b9e\u4f8b\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/1cb30d9536293b08fe2097448858e58e3826a242.png",alt:"image-20221107150428406"})),(0,l.kt)("p",null,"\u6211\u4eec\u6539\u9020",(0,l.kt)("inlineCode",{parentName:"p"},"App"),"\u7ec4\u4ef6"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"export default function App() {\n  const childRef = useRef(null)\n\n  childRef.current.value = 'App\u7ec4\u4ef6\u8bbe\u7f6e\u7684'\n\n  return (\n    <div>\n      <h2>\u8fd9\u662fApp\u7ec4\u4ef6</h2>\n      <Child ref={childRef} />\n    </div>\n  )\n}\n")),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/97b65dfb2775fb6d2b94e3e7e0bd1c57a0f45571.png",alt:"image-20221107150535398"})),(0,l.kt)("p",null,"\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728",(0,l.kt)("inlineCode",{parentName:"p"},"App"),"\u7ec4\u4ef6\u64cd\u4f5c",(0,l.kt)("inlineCode",{parentName:"p"},"Child"),"\u7ec4\u4ef6\u7684\u5185\u5bb9\uff0c\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u597d\uff0c\u6211\u4eec\u5e0c\u671b",(0,l.kt)("inlineCode",{parentName:"p"},"Child"),"\u7ec4\u4ef6\u7684\u5185\u5bb9\u53ea\u7531",(0,l.kt)("inlineCode",{parentName:"p"},"Child"),"\u7ec4\u4ef6\u81ea\u5df1\u53bb\u64cd\u4f5c\uff0c\u6240\u4ee5\u5f15\u51fa\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"useImperativeHandle")),(0,l.kt)("h2",{id:"5useimperativehandle"},"5.useImperativeHandle"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"useImperativeHandle(ref, createHandle, [deps])\n")),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"useImperativeHandle")," \u53ef\u4ee5\u8ba9\u4f60\u5728\u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"ref")," \u65f6\u81ea\u5b9a\u4e49\u66b4\u9732\u7ed9\u7236\u7ec4\u4ef6\u7684\u5b9e\u4f8b\u503c\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u5e94\u5f53\u907f\u514d\u4f7f\u7528 ref \u8fd9\u6837\u7684\u547d\u4ee4\u5f0f\u4ee3\u7801\u3002",(0,l.kt)("inlineCode",{parentName:"p"},"useImperativeHandle")," \u5e94\u5f53\u4e0e ",(0,l.kt)("a",{parentName:"p",href:"https://zh-hans.reactjs.org/docs/react-api.html#reactforwardref"},(0,l.kt)("inlineCode",{parentName:"a"},"forwardRef"))," \u4e00\u8d77\u4f7f\u7528\uff1a"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"App.jsx")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-jsx"},"import React, { useRef, useEffect, useImperativeHandle } from 'react'\n\nconst Child = React.forwardRef((props, ref) => {\n  const inputRef = useRef(null)\n\n  const changeInputValue = value => (inputRef.current.value = value)\n\n  // useImperativeHandle \u53ef\u4ee5\u7528\u6765\u6307\u5b9aref\u8fd4\u56de\u7684\u503c\n  useImperativeHandle(ref, () => ({\n    changeInputValue,\n  }))\n\n  return (\n    <>\n      <h2>\u8fd9\u662fChild\u7ec4\u4ef6</h2>\n      <input type=\"text\" ref={inputRef} />\n    </>\n  )\n})\n\nexport default function App() {\n  const childRef = useRef(null)\n\n  useEffect(() => {\n    console.log(childRef)\n  }, [])\n\n  return (\n    <div>\n      <h2>\u8fd9\u662fApp\u7ec4\u4ef6</h2>\n      <button onClick={() => childRef.current.changeInputValue('App\u7ec4\u4ef6\u4fee\u6539\u7684')}>\u70b9\u51fb\u6539\u53d8</button>\n      <Child ref={childRef} />\n    </div>\n  )\n}\n")),(0,l.kt)("p",null,"\u6211\u4eec\u6765\u770b\u770b",(0,l.kt)("inlineCode",{parentName:"p"},"childRef"),"\u7684\u8f93\u51fa\u662f\u4ec0\u4e48"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/bf501a8976223d92e9330a13aadba40a623e73b0.png",alt:"image-20221107151926890"})),(0,l.kt)("p",null,"\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u628a\u5b50\u7ec4\u4ef6\u7684",(0,l.kt)("inlineCode",{parentName:"p"},"changeInputValue"),"\u66b4\u9732\u51fa\u53bb\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{parentName:"p",src:"https://i0.hdslb.com/bfs/album/fb13b0f4d452eae98a26edeabc03076defb73f52.png",alt:"image-20221107152122394"})),(0,l.kt)("p",null,"\u70b9\u51fb\u6309\u94ae\u53d1\u73b0\u4e5f\u662f\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u7684\u3002"))}s.isMDXComponent=!0}}]);